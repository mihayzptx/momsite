/**
 * ChildData.js
 * ------------
 * This module provides child development data for the prototype.
 * For a real implementation, this would be stored in a database.
 */

// Development milestones by month (1-36 months)
const childDevelopmentData = {
  // 1-3 months
  1: {
    physical: [
      'Lifts head briefly during tummy time',
      'Makes fists with hands',
      'Moves arms and legs in swimming motions'
    ],
    cognitive: [
      'Stares at faces and high-contrast patterns',
      'Follows objects with eyes',
      'Recognizes familiar voices'
    ],
    social: [
      'Begins to smile at people',
      'May mimic facial expressions briefly',
      'Becomes more expressive with face and body'
    ],
    activitiesToTry: [
      'Tummy time (supervised)',
      'Black and white contrast cards',
      'Talk and sing to your baby',
      'Mirror play'
    ],
    healthChecks: [
      'First well-baby visit (2-3 days after discharge)',
      'Check weight gain and feeding',
      'First set of immunizations at 2 months'
    ]
  },
  
  // 4-6 months
  6: {
    physical: [
      'Rolls over in both directions',
      'Begins to sit with support',
      'Supports weight when standing',
      'Reaches for and grasps objects'
    ],
    cognitive: [
      'Explores objects with mouth',
      'Responds to sounds by making sounds',
      'Shows curiosity and tries to get out-of-reach objects'
    ],
    social: [
      'Recognizes familiar people',
      'Enjoys playing with others',
      'Responds to emotions of others',
      'Likes to look at self in mirror'
    ],
    activitiesToTry: [
      'Floor play with age-appropriate toys',
      'Reading board books',
      'Songs with hand movements',
      'Sitting practice with support'
    ],
    healthChecks: [
      '4-month well-baby visit',
      '6-month well-baby visit',
      'Continued immunizations',
      'Introduction of solid foods around 6 months'
    ]
  },
  
  // 7-9 months
  9: {
    physical: [
      'Sits without support',
      'Crawls or uses alternate movement to get around',
      'Pulls to stand',
      'Develops pincer grasp (thumb and forefinger)'
    ],
    cognitive: [
      'Tracks moving objects well',
      'Looks for hidden objects',
      'Explores objects in different ways',
      'Begins to understand object permanence'
    ],
    social: [
      'Distinguishes familiar people from strangers',
      'May show anxiety around strangers',
      'Responds to own name',
      'Communicates with gestures like pointing'
    ],
    activitiesToTry: [
      'Peek-a-boo games',
      'Stacking and nesting toys',
      'Crawling games and obstacles',
      'Simple finger foods for practice'
    ],
    healthChecks: [
      '9-month well-baby visit',
      'Check crawling/mobility progress',
      'Review feeding and sleeping patterns',
      'Discuss safety as baby becomes more mobile'
    ]
  },
  
  // 10-12 months
  12: {
    physical: [
      'May take first steps alone',
      'Gets into sitting position without help',
      'Pulls up to stand and walks holding onto furniture',
      'Can drink from a cup and use finger foods'
    ],
    cognitive: [
      'Responds to simple verbal requests',
      'Uses objects correctly (phone to ear, brush for hair)',
      'Explores objects in many ways',
      'Begins to use objects for their intended purposes'
    ],
    social: [
      'Cries when parents leave',
      'Shows specific preferences for people',
      'Tests parental responses to behavior',
      'May say "mama" and "dada" with meaning'
    ],
    activitiesToTry: [
      'Push and pull toys',
      'Simple shape sorters',
      'Music and movement activities',
      'Supervised standing and cruising practice'
    ],
    healthChecks: [
      '12-month well-baby visit',
      'Review development and growth',
      'Discuss transition from formula/breast milk to whole milk',
      'Additional immunizations'
    ]
  },
  
  // 13-18 months
  18: {
    physical: [
      'Walks alone',
      'May run and climb stairs with help',
      'Can build tower of 2-4 blocks',
      'Feeds self with spoon'
    ],
    cognitive: [
      'Points to get attention of others',
      'Knows names of familiar people and body parts',
      'Follows 1-step verbal commands',
      'Begins to sort shapes and colors'
    ],
    social: [
      'Engages in parallel play',
      'Imitates behaviors of others',
      'Shows increasing independence',
      'May have temper tantrums',
      'Shows affection to familiar people'
    ],
    activitiesToTry: [
      'Simple puzzles',
      'Drawing with large crayons',
      'Naming body parts during bath time',
      'Ball play (rolling, throwing)',
      'Interactive songs and rhymes'
    ],
    healthChecks: [
      '15-month well-baby visit',
      '18-month well-baby visit',
      'Review language development',
      'Discuss toilet training readiness',
      'Assess walking and motor skills'
    ]
  },
  
  // 19-24 months
  24: {
    physical: [
      'Runs and jumps',
      'Kicks and throws ball',
      'Climbs onto and down from furniture without help',
      'Walks up and down stairs with support',
      'Turns pages in a book'
    ],
    cognitive: [
      'Finds objects even when hidden under 2-3 covers',
      'Begins to engage in pretend play',
      'Might follow 2-step instructions',
      'Begins to sort by shapes and colors',
      'Completes sentences and rhymes in familiar books'
    ],
    social: [
      'Shows increasing independence',
      'Begins to include other children in play',
      'Shows defiant behavior',
      'Increasingly aware of self as separate from others',
      'Uses phrases and sentences to communicate'
    ],
    activitiesToTry: [
      'Matching and sorting games',
      'Simple pretend play scenarios',
      'Outdoor play with running and climbing',
      'Reading and naming pictures in books',
      'Art activities with various materials'
    ],
    healthChecks: [
      '24-month well-child visit',
      'Assess language development (should use 50+ words)',
      'Growth evaluation',
      'Vision and hearing screening',
      'Discussion of behavior and discipline strategies'
    ]
  },
  
  // 25-30 months
  30: {
    physical: [
      'Jumps in place',
      'Throws ball overhand',
      'Builds tower of more than 6 blocks',
      'Stands on tiptoes',
      'Begins to show hand preference'
    ],
    cognitive: [
      'Can name most familiar objects',
      'Understands the concept of "two"',
      'Follows 2-3 step instructions',
      'Plays make-believe with dolls, animals, and people',
      'Sorts objects by color'
    ],
    social: [
      'Copies adults and friends',
      'Shows affection for friends without prompting',
      'Takes turns in games',
      'Shows concern for crying friend',
      'Separates easily from parents'
    ],
    activitiesToTry: [
      'Puzzles with 3-5 pieces',
      'Color and shape identification games',
      'Pretend play with props',
      'Simple obstacle courses',
      'Counting games and songs'
    ],
    healthChecks: [
      '30-month developmental check (if recommended)',
      'Continue discussions about toilet training',
      'Monitor speech development',
      'Discuss sleep patterns and transition to bed'
    ]
  },
  
  // 31-36 months
  36: {
    physical: [
      'Climbs well',
      'Pedals tricycle',
      'Runs easily',
      'Walks up and down stairs with alternating feet',
      'Can briefly balance on one foot'
    ],
    cognitive: [
      'Can work toys with buttons, levers, and moving parts',
      'Plays make-believe with dolls, animals, and people',
      'Does puzzles with 3-4 pieces',
      'Copies a circle',
      'Understands concept of "same" and "different"'
    ],
    social: [
      'Takes turns in games',
      'Shows concern for a crying friend',
      'Understands the concept of "mine" and "theirs"',
      'Expresses a wide range of emotions',
      'Separates easily from parents'
    ],
    language: [
      'Follows 2-3 part commands',
      'Recognizes and names most familiar objects',
      'Understands words like "in," "on," and "under"',
      'Says first name, age, and gender',
      'Uses pronouns and plurals'
    ],
    activitiesToTry: [
      'Simple board games that teach taking turns',
      'Arts and crafts projects',
      'Dress-up and role-playing',
      'Tricycle or ride-on toys',
      'Sorting activities with increasing complexity'
    ],
    healthChecks: [
      '36-month well-child visit',
      'Comprehensive developmental screening',
      'Vision and hearing check',
      'Discussion about preschool readiness',
      'Review immunization records'
    ]
  }
};

// Function to get development data for a specific month
function getChildDevelopmentData(ageInMonths) {
  // If we have data for the exact month, return it
  if (childDevelopmentData[ageInMonths]) {
    return childDevelopmentData[ageInMonths];
  }
  
  // Otherwise, return the closest month data we have
  const months = Object.keys(childDevelopmentData).map(Number).sort((a, b) => a - b);
  
  // Find the closest month we have data for
  let closestMonth = months[0];
  let minDistance = Math.abs(ageInMonths - closestMonth);
  
  for (const availableMonth of months) {
    const distance = Math.abs(ageInMonths - availableMonth);
    if (distance < minDistance) {
      closestMonth = availableMonth;
      minDistance = distance;
    }
  }
  
  return childDevelopmentData[closestMonth];
}

// Function to calculate child's age in months
function calculateAgeInMonths(birthdate) {
  const birth = new Date(birthdate);
  const now = new Date();
  
  let months = (now.getFullYear() - birth.getFullYear()) * 12;
  months -= birth.getMonth();
  months += now.getMonth();
  
  // Adjust for day of month
  if (now.getDate() < birth.getDate()) {
    months--;
  }
  
  return Math.max(0, months); // Ensure non-negative
}

// Function to get upcoming milestones based on current age
function getUpcomingMilestones(ageInMonths) {
  // Find the next milestone month
  const months = Object.keys(childDevelopmentData).map(Number).sort((a, b) => a - b);
  const nextMilestones = months.filter(month => month > ageInMonths);
  
  if (nextMilestones.length === 0) {
    // If child is older than our oldest milestone, return the last one
    return childDevelopmentData[months[months.length - 1]];
  }
  
  return childDevelopmentData[nextMilestones[0]];
}

module.exports = {
  childDevelopmentData,
  getChildDevelopmentData,
  calculateAgeInMonths,
  getUpcomingMilestones
};